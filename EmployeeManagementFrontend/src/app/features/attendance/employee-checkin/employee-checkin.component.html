<div class="page-shell">
  <mat-card class="checkin-card">
    <mat-card-content>
      <div class="center">
        <ng-container *ngIf="checkingStatus; else statusTpl">
          <mat-progress-spinner
            diameter="48"
            mode="indeterminate"
          ></mat-progress-spinner>
          <div class="muted">Checking status…</div>
        </ng-container>

        <ng-template #statusTpl>
          <div *ngIf="isCheckedIn; else notCheckedIn">
            <h2 class="title">
              You already checked in at
              {{ checkInTimeCairo | date : "h:mm a" : "Africa/Cairo" }}
            </h2>

            <div class="actions">
              <button
                mat-stroked-button
                color="primary"
                (click)="openHistory()"
              >
                <mat-icon>history</mat-icon>
                View history
              </button>
            </div>
          </div>

          <ng-template #notCheckedIn>
            <mat-icon class="big-icon">access_time</mat-icon>
            <h2 class="title">Ready to check in?</h2>
            <div class="sub">
              You can check in once between the allowed check-in window.
            </div>

            <div class="actions">
              <button
                mat-flat-button
                color="primary"
                (click)="doCheckIn()"
                [disabled]="loading"
              >
                <mat-icon *ngIf="!loading">login</mat-icon>
                <mat-progress-spinner
                  *ngIf="loading"
                  diameter="20"
                  mode="indeterminate"
                ></mat-progress-spinner>
                <span class="btn-text">{{
                  loading ? "Checking in…" : "Check in"
                }}</span>
              </button>
              <button mat-button (click)="openHistory()">History</button>
            </div>
          </ng-template>
        </ng-template>
      </div>
    </mat-card-content>
  </mat-card>
</div>
